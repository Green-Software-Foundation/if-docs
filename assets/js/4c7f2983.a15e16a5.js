"use strict";(self.webpackChunkgreen_software_training=self.webpackChunkgreen_software_training||[]).push([[2186],{4137:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>d});var r=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=r.createContext({}),u=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},c=function(e){var n=u(e.components);return r.createElement(s.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),m=u(t),d=i,g=m["".concat(s,".").concat(d)]||m[d]||l[d]||o;return t?r.createElement(g,a(a({ref:n},c),{},{components:t})):r.createElement(g,a({ref:n},c))}));function d(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,a=new Array(o);a[0]=m;var p={};for(var s in n)hasOwnProperty.call(n,s)&&(p[s]=n[s]);p.originalType=e,p.mdxType="string"==typeof e?e:i,a[1]=p;for(var u=2;u<o;u++)a[u]=t[u];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},5608:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>p,toc:()=>u});var r=t(7462),i=(t(7294),t(4137));const o={sidebar_position:7},a="Regroup",p={unversionedId:"major-concepts/regroup",id:"major-concepts/regroup",title:"Regroup",description:"Regroup is an IF feature that reorganizes a tree according to keys provided by the user. This allows users to regroup their observations according to various properties of their application. For example, the following IMP file contains a flat array of observations. This is how you might expect data to arrive from an importer plugin, maybe one that hits a metrics API for a cloud service.",source:"@site/docs/major-concepts/regroup.md",sourceDirName:"major-concepts",slug:"/major-concepts/regroup",permalink:"/major-concepts/regroup",draft:!1,editUrl:"https://github.com/Green-Software-Foundation/if-docs/edit/master/docs/major-concepts/regroup.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Plugins",permalink:"/major-concepts/plugins"},next:{title:"Pipelines",permalink:"/major-concepts/pipelines"}},s={},u=[{value:"Using <code>regroup</code>",id:"using-regroup",level:2}],c={toc:u};function l(e){let{components:n,...t}=e;return(0,i.kt)("wrapper",(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"regroup"},"Regroup"),(0,i.kt)("p",null,"Regroup is an IF feature that reorganizes a tree according to keys provided by the user. This allows users to regroup their observations according to various properties of their application. For example, the following IMP file contains a flat array of observations. This is how you might expect data to arrive from an importer plugin, maybe one that hits a metrics API for a cloud service."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"name: if-demo\ndescription: demo pipeline\ntree:\n  children:\n    my-app:\n      pipeline:\n        observe:\n        regroup:\n          - cloud-region\n          - instance-type     \n        compute:\n          - teads-curve\n      inputs:\n        - timestamp: 2023-07-06T00:00\n          duration: 300 \n          instance-type: A1 \n          region: uk-west\n          cpu-util: 99\n        - timestamp: 2023-07-06T05:00 \n          duration: 300 \n          instance-type: A1 \n          region: uk-west\n          cpu-util: 23    \n        - timestamp: 2023-07-06T10:00\n          duration: 300\n          instance-type: A1 \n          region: uk-west\n          cpu-util: 12\n        - timestamp: 2023-07-06T00:00 # note this time restarts at the start timstamp\n          duration: 300 \n          instance-type: B1\n          region: uk-west\n          cpu-util: 11\n        - timestamp: 2023-07-06T05:00 \n          duration: 300 \n          instance-type: B1\n          region: uk-west\n          cpu-util: 67\n        - timestamp: 2023-07-06T10:00\n          duration: 300 \n          instance-type: B1\n          region: uk-west\n          cpu-util: 1     \n")),(0,i.kt)("p",null,"However, each observation contains an ",(0,i.kt)("inlineCode",{parentName:"p"},"instance-type")," field that varies between observations. There are two instance types being represented in this array of observations. This means there are duplicate entries for the same timestamp in this array. This is the problem that ",(0,i.kt)("inlineCode",{parentName:"p"},"regroup")," solves. You provide ",(0,i.kt)("inlineCode",{parentName:"p"},"instance-type")," as a key in the ",(0,i.kt)("inlineCode",{parentName:"p"},"regroup")," config and it extracts the data belonging to the different instances and separates them into independent arrays. The above example would be restructured so that instance types ",(0,i.kt)("inlineCode",{parentName:"p"},"A1")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"B1")," have their own data, as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"children:\n  A1:\n      inputs:\n      - timestamp: 2023-07-06T00:00\n          duration: 300\n          instance-type: A1\n          region: uk-west\n          cpu-util: 99\n      - timestamp: 2023-07-06T05:00\n          duration: 300\n          instance-type: A1\n          region: uk-west\n          cpu-util: 23\n      - timestamp: 2023-07-06T10:00\n          duration: 300\n          instance-type: A1\n          region: uk-west\n          cpu-util: 12\n  B1:\n      inputs:\n      - timestamp: 2023-07-06T00:00\n          duration: 300\n          instance-type: B1\n          region: uk-east\n          cpu-util: 11\n      - timestamp: 2023-07-06T05:00\n          duration: 300\n          instance-type: B1\n          region: uk-east\n          cpu-util: 67\n      - timestamp: 2023-07-06T10:00\n          duration: 300\n          instance-type: B1\n          region: uk-east\n          cpu-util: 1          \n")),(0,i.kt)("h2",{id:"using-regroup"},"Using ",(0,i.kt)("inlineCode",{parentName:"h2"},"regroup")),(0,i.kt)("p",null,"To use ",(0,i.kt)("inlineCode",{parentName:"p"},"regroup"),", you simply provide the keys you want to regroup by in the ",(0,i.kt)("inlineCode",{parentName:"p"},"regroup")," pipeline. ",(0,i.kt)("inlineCode",{parentName:"p"},"regroup")," is NOT a plugin, it is a core feature of IF that is executed when you run ",(0,i.kt)("inlineCode",{parentName:"p"},"if-run")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"if-run --regroup")," if the config is available in the IMP file."),(0,i.kt)("p",null,"The config is provided at the node level, and it looks as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"tree:\n  children:\n    my-app:\n      pipeline:\n        observe:\n        regroup:\n          - cloud-region\n          - instance-type  \n")),(0,i.kt)("p",null,"In the example above, the plugin would regroup the input data for the specific component by ",(0,i.kt)("inlineCode",{parentName:"p"},"cloud-region")," and by ",(0,i.kt)("inlineCode",{parentName:"p"},"instance-type"),"."))}l.isMDXComponent=!0}}]);